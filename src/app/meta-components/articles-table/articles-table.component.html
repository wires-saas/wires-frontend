<div class="card">
    <p-table #dt1 [value]="articles" dataKey="id" [rows]="10" [loading]="loading" [rowHover]="true" styleClass="p-datatable-gridlines"
             [paginator]="true" [globalFilterFields]="['metadata.title','metadata.description', 'metadata.categories']" responsiveLayout="scroll">
        <ng-template pTemplate="caption">
            <div class="flex justify-content-between flex-column sm:flex-row">
                <button pButton i18n-label label="Clear" class="p-button-outlined mb-2" icon="pi pi-filter-slash" (click)="clear(dt1)"></button>


                <div class="flex flex-wrap gap-2 mb-2">
                    <div class="flex">
                        <input pInputText type="text" #filter (input)="onGlobalFilter(dt1, $event)"
                               i18n-placeholder placeholder="Search Keyword" class="w-full"/>
                    </div>

                    <button pButton class="flex w-full sm:w-auto flex-order-0 sm:flex-order-1" icon="pi pi-tag"
                            i18n-label label="Create Tag From Filters"></button>

                </div>
            </div>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th style="min-width: 14rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Image</span>
                        <p-columnFilter type="text" field="metadata.image" display="menu" placeholder="Search by image"></p-columnFilter>
                    </div>
                </th>

                <th style="min-width: 12rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Title</span>
                        <p-columnFilter type="text" field="metadata.title" display="menu" placeholder="Search by title"></p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 12rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Description</span>
                        <p-columnFilter type="text" field="metadata.description" display="menu" placeholder="Search by description"></p-columnFilter>
                    </div>
                </th>

                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Publication</span>
                        <p-columnFilter type="date" field="metadata.publishedAt" display="menu" placeholder="dd/mm/yyyy"></p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 10rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Categories</span>
                        <p-columnFilter field="status" matchMode="equals" display="menu">
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-dropdown [ngModel]="value" [options]="statuses" (onChange)="filter($event.value)" placeholder="Any" [style]="{'min-width': '12rem'}" >
                                    <ng-template let-option pTemplate="item">
                                        <span [class]="'customer-badge status-' + option.value">{{option.label}}</span>
                                    </ng-template>
                                </p-dropdown>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 12rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Tags</span>
                        <p-columnFilter field="status" matchMode="equals" display="menu">
                            <ng-template pTemplate="filter" let-value let-filter="filterCallback">
                                <p-dropdown [ngModel]="value" [options]="statuses" (onChange)="filter($event.value)" placeholder="Any" [style]="{'min-width': '12rem'}" >
                                    <ng-template let-option pTemplate="item">
                                        <span [class]="'customer-badge status-' + option.value">{{option.label}}</span>
                                    </ng-template>
                                </p-dropdown>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
                <th style="min-width: 12rem">
                    <div class="flex justify-content-between align-items-center">
                        <span i18n>Popularity</span>
                        <p-columnFilter field="activity" matchMode="between" display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false">
                            <ng-template pTemplate="filter" let-filter="filterCallback">
                                <p-slider [ngModel]="activityValues" [range]="true" (onSlideEnd)="filter($event.values)" styleClass="m-3" [style]="{'min-width': '12rem'}" ></p-slider>
                                <div class="flex align-items-center justify-content-between px-2">
                                    <span>{{activityValues[0]}}</span>
                                    <span>{{activityValues[1]}}</span>
                                </div>
                            </ng-template>
                        </p-columnFilter>
                    </div>
                </th>
            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-article>
            <tr>
                <td style="padding: 0;">
                    <img [src]="article.metadata.image" alt="" [title]="article.metadata.image" style="vertical-align: middle"/>
                </td>
                <td>
                    {{ article.metadata.title }}
                </td>
                <td>
                    {{ article.metadata.description }}
                </td>

                <td>
                    {{ article.createdAt | date: 'dd/MM/yyyy'}}
                </td>
                <td class="text-center">
                    <p-chip *ngFor="let category of article.metadata.categories" [label]="category" class="inline-block m-1"></p-chip>
                </td>
                <td class="text-center">
                    <p-tag *ngFor="let tag of article.tags; let k = index" [severity]="getTagSeverity(k)" [value]="tag" class="inline-block m-1"></p-tag>
                </td>
                <td>
                    <p-progressBar [value]="article.stats.clicked / article.stats.displayed * 100"
                                   [showValue]="false" [style]="{'height': '1.5rem'}"></p-progressBar>
                </td>
            </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="7" i18n>No articles found.</td>
            </tr>
        </ng-template>
        <ng-template pTemplate="loadingbody">
            <tr>
                <td colspan="7" i18n>Loading articles data. Please wait.</td>
            </tr>
        </ng-template>
    </p-table>
</div>
